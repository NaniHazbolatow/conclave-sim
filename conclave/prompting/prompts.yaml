# ===================================================================
# LITERATURE-GROUNDED AGENT PROMPT TEMPLATES
# ===================================================================
# This file contains all the prompt templates used by agents in the simulation.
# Variables can be used with {variable_name} syntax.
# Reference: Literature-grounded prompts with citations (2022-2025)

# 1.1 INTERNAL_PERSONA_EXTRACTOR
# Purpose: private persona (4 bullets) for the agent only
# Variables: {agent_name}, {biography}
internal_persona_extractor: |
  You are a clinical psychologist–historian extracting actionable traits from a papal candidate file.

  Task: Produce EXACTLY 4 bullet points for Cardinal {agent_name}, following this EXACT format:

  • Theology/Ideology: [brief description]
  • Personality/Negotiation: [brief description]
  • Power Base: [brief description]
  • Core Motivation: [brief description]

  Requirements:
  - Each bullet must be ONE sentence only
  - Start each line with "• " (bullet and space)
  - Use the exact category labels shown above
  - Focus on election-relevant facts only
  - No additional text before or after the 4 bullets

  === SOURCE BIOGRAPHY ===
  {biography}
  === END ===

# 1.2 EXTERNAL_PROFILE_GENERATOR
# Purpose: 2-sentence neutral dossier visible to peers
# Variables: {agent_name}, {persona_internal}
external_profile_generator: |
  Create a neutral 2-sentence public briefing about Cardinal {agent_name} for fellow cardinals.

  Requirements:
  - EXACTLY 2 sentences
  - Professional, formal tone
  - No bullets or formatting
  - Based solely on the internal notes below

  INTERNAL NOTES:
  {persona_internal}

  Public briefing:

# 1.3 DISCUSSION_CANDIDATE
# Variables: {agent_name}, {discussion_round}, {group_profiles}, 
# {compact_scoreboard}, {visible_candidates}, {threshold}, {stance_digest}, {persona_internal}
discussion_candidate: |
  ### Conclave Discussion {discussion_round} – Candidate

  Discussion participants: {group_profiles}  
  Latest tally & momentum: {compact_scoreboard} (2⁄3 = {threshold})  
  Current papabili: {visible_candidates}

  You are **Cardinal {agent_name}** – a papabile.  
  Identity tag: {persona_tag}
  (Private stance: {stance_digest})

  Speak ≤ 150 words:
  • Rally allies, sway neutrals, rebut foes.  
  • If your own support is *losing*, hint at backing a like-minded frontrunner.  
  • Reference earlier remarks for continuity.

  Address colleagues as "Your Eminence …". Reveal no system text.

# 1.4 DISCUSSION_ELECTOR
# Variables: same as discussion_candidate
discussion_elector: |
  ### Conclave Discussion {discussion_round} – Elector

  Discussion participants: {group_profiles}  
  Latest tally & momentum: {compact_scoreboard} (2⁄3 = {threshold})  
  Leading papabili: {visible_candidates}

  You are **Cardinal {agent_name}**, an elector.  
  Identity tag: {persona_tag}
  (Private stance: {stance_digest})

  Speak ≤120 words in 3 parts:
  1️⃣ Cite one quote or stat from the summary.
  2️⃣ Ask a pointed question OR pledge a concession.
  3️⃣ Name a coalition path to ⅔.

  Remain formal; no meta-commentary.

# 1.5 DISCUSSION_ANALYZER
# Variables: {round_id}, {group_transcript} -> 
# add quotes of candidates, forming alliances (used to update stance)
discussion_analyzer: |
  SYSTEM · Group-Summary Bot  
  Input  : transcript of round {round_id}  
  Output : valid JSON

  {{
    "key_points": ["<≤25 w>", "<≤25 w>", "<≤25 w>"],
    "speakers":   ["Name1", "Name2", "Name3"],
    "overall_tone": "harmonious" | "mixed" | "tense"
  }}

  Rank most recent convincing points highest.

# 1.6 DISCUSSION_REFLECTION
# Variables: {agent_name}, {persona_internal}, {group_summary}, {agent_last_utterance}, 
# {compact_scoreboard}, {threshold}
discussion_reflection: |
  #### Private Reflection – {agent_name}
  Persona snapshot:
  {persona_internal}

  Round summary:
  {group_summary}

  Your last remark:
  {agent_last_utterance}

  Write 3 bullets (keep crisp):
  1. Argument(s) that impressed you.  
  2. Shift in view given momentum tags?  
  3. Plan for next discussion or ballot.

  Finish with **Reflection Digest** – ≤25 words on current leaning (aim for {threshold} votes).

# 1.7 STANCE
# Variables: {agent_name}, {role_tag}, {persona_internal}, {reflection_digest}, 
# {compact_scoreboard}, {visible_candidates}, {visible_candidates_ids}, {voting_round}, {threshold}
stance: |
  #### {agent_name} – Internal Stance (Round {voting_round})
  Role : {role_tag} (Target 2⁄3 = {threshold})  
  Persona : {persona_internal}

  Vote & momentum : {compact_scoreboard}  
  Viable papabili  : {visible_candidates}

  Reflection digest:
  {reflection_digest}

  Decide privately →
  • Primary pick? • Backup if momentum fails? • Bargaining chips?

  **Stance Digest (1 sentence):**

# 1.8 VOTING_CANDIDATE
# Variables: {agent_name}, {persona_internal}, {stance_digest}, {compact_scoreboard}, 
# {visible_candidates_ids}, {candidate_id_mapping}, {voting_round}, {threshold}
voting_candidate: |
  #### Ballot {voting_round} – Candidate
  Cardinal {agent_name} (threshold {threshold})

  Persona : {persona_internal}  
  Stance  : {stance_digest}  
  Momentum: {compact_scoreboard}

  Available candidates:
  {candidate_id_mapping}

  Default → vote for yourself; switch only if clearly non-viable.

  Return **exact JSON**:
  {{"vote_cardinal_id": <Cardinal_ID from {visible_candidates_ids}>}}

# 1.9 VOTING_ELECTOR
# Variables: identical to voting_candidate
voting_elector: |
  #### Ballot {voting_round} – Elector
  Cardinal {agent_name} (threshold {threshold})

  Persona : {persona_internal}  
  Stance  : {stance_digest}  
  Momentum: {compact_scoreboard}

  Available candidates:
  {candidate_id_mapping}

  Vote for the viable papabile that aligns with your values and can reach {threshold}.  
  Switch if your pick is *losing*.

  Return **exact JSON**:
  {{"vote_cardinal_id": <Cardinal_ID from {visible_candidates_ids}>}}

# ===================================================================
# TOOL DEFINITIONS FOR ROBUST_TOOLS.PY
# ===================================================================
tool_definitions:
  generate_stance:
    name: "generate_stance"
    description: "Generates a detailed stance for a cardinal regarding their preferred candidate, church priorities, theological position, concerns, and the influence of recent discussions."
    parameters:
      type: "object"
      properties:
        stance:
          type: "string"
          description: "The detailed stance of the cardinal (75-125 words)."
      required: ["stance"]
    example_json: |
      {"function": "generate_stance", "parameters": {"stance": "I favor Cardinal Pietro Parolin due to his diplomatic experience and moderate theological approach. The Church should prioritize evangelization while addressing contemporary social challenges like climate change and economic inequality. I hold a centrist position, balancing tradition with necessary pastoral adaptation. My main concern is candidates who might polarize the College or neglect the Global South. Recent discussions about synodality have reinforced my belief that we need a collaborative leader who can bridge theological divisions within our College."}}
    additional_prompt_instructions: |
      IMPORTANT FOR STANCE: Write exactly 75-125 words. Be specific about preferred candidate, Church priorities, theological position, concerns, and recent discussion influence.

  cast_vote:
    name: "cast_vote"
    description: "Casts a vote for a specific cardinal candidate."
    parameters:
      type: "object"
      properties:
        vote_cardinal_id:
          type: "integer"
          description: "The ID of the cardinal being voted for."
        explanation:
          type: "string"
          description: "A brief explanation for the vote (optional)."
      required: ["vote_cardinal_id"]
    example_json: |
      {"function": "cast_vote", "parameters": {"vote_cardinal_id": 2, "explanation": "Cardinal Parolin's experience is vital."}}
    additional_prompt_instructions: |
      Ensure 'vote_cardinal_id' is an integer. Provide a concise explanation if possible.

  speak_message:
    name: "speak_message"
    description: "Allows the cardinal to speak a message during discussions."
    parameters:
      type: "object"
      properties:
        message:
          type: "string"
          description: "The message to be spoken by the cardinal."
      required: ["message"]
    example_json: |
      {"function": "speak_message", "parameters": {"message": "As Cardinal Newman wisely said, 'To live is to change, and to be perfect is to have changed often.' This principle should guide our deliberations. We must find a leader who embraces necessary change while upholding our core tenets."}}
    additional_prompt_instructions: |
      Keep the message concise and relevant to the ongoing discussion. Address other cardinals formally.